backend:
  name: git-gateway
  branch: main

# --- MODIFICATION 1 ---
# On spécifie le chemin absolu pour les images générales du site.
# Le "/" au début est crucial : il signifie "à partir de la racine du projet".
media_folder: "/image"
public_folder: "/image"

collections:
  - name: "evenements"
    label: "Événements"
    folder: "_evenements"
    create: true
    slug: "{{year}}-{{month}}-{{day}}-{{slug}}"
    extension: "json"
    fields:
      - {label: "Titre", name: "titre", widget: "string"}
      - {label: "Date et Heure", name: "date", widget: "datetime"}
      - {label: "Lieu", name: "lieu", widget: "string"}
      - {label: "Tarif", name: "tarif", widget: "string", required: false}
      - {label: "Description (avant l'événement)", name: "description", widget: "text"}
      - {label: "Compte-rendu (après l'événement)", name: "compte_rendu", widget: "markdown", required: false}
      - label: "Photos de l'événement"
        name: "photos"
        widget: "list"
        required: false
        fields:
          - label: "Image"
            name: "image"
            widget: "image"
            # --- MODIFICATION 2 ---
            # On spécifie ici aussi un chemin absolu pour les photos des archives.
            # Le CMS ne pourra plus se tromper et créer un sous-dossier.
            media_folder: "/image/archive"
            public_folder: "/image/archive"
          - {label: "Légende", name: "legende", widget: "string", required: false}

  - name: "permanences"
    label: "Permanences"
    folder: "_permanences"
    create: true
    slug: "{{slug}}"
    extension: "json"
    fields:
      - {label: "Titre", name: "titre", widget: "string"}
      - {label: "Jour de la semaine", name: "jour", widget: "string"}
      - {label: "Heure", name: "heure", widget: "string"}
      - {label: "Lieu", name: "lieu", widget: "string"}
      - {label: "Description", name: "description", widget: "text"}
